!function(){if("object"!=typeof JSON){JSON={};var t,e,n,r,u=/^[\],:{}\s]*$/,i=/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,o=/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,p=/(?:^|:|,)(?:\s*\[)+/g,a=/[\\"\u0000-\u001f\u007f-\u009f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;"function"!=typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":"Invalid Date"}),"function"!=typeof JSON.stringify&&(n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},JSON.stringify=function(n,u,i){var o;if(t="",e="","number"==typeof i)for(o=0;o<i;o+=1)e+=" ";else"string"==typeof i&&(e=i);if(r=u,u&&"function"!=typeof u&&("object"!=typeof u||"number"!=typeof u.length))throw new Error("JSON.stringify");return str("",{"":n})}),"function"!=typeof JSON.parse&&(JSON.parse=function(t,e){var n;function walk(t,n){var r,u,i=t[n];if(i&&"object"==typeof i)for(r in i)Object.prototype.hasOwnProperty.call(i,r)&&((u=walk(i,r))!==undefined?i[r]=u:delete i[r]);return e.call(t,n,i)}if(t=String(t),c.lastIndex=0,c.test(t)&&(t=t.replace(c,(function(t){return"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))),u.test(t.replace(i,"@").replace(o,"]").replace(p,"")))return n=Function("return ("+t+")")(),"function"==typeof e?walk({"":n},""):n;throw new Error("JSON.parse")})}function f(t){return t<10?"0"+t:t}function quote(t){return a.lastIndex=0,a.test(t)?'"'+t.replace(a,(function(t){var e=n[t];return"string"==typeof e?e:"\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(-4)}))+'"':'"'+t+'"'}function str(n,u){var i,o,p,a,c,s=t,l=u[n];switch(l&&"object"==typeof l&&"function"==typeof l.toJSON&&(l=l.toJSON(n)),"function"==typeof r&&(l=r.call(u,n,l)),typeof l){case"string":return quote(l);case"number":return isFinite(l)?String(l):"null";case"boolean":return String(l);case"object":if(!l)return"null";if(t+=e,c=[],"[object Array]"===Object.prototype.toString.apply(l)){for(a=l.length,i=0;i<a;i+=1)c[i]=str(String(i),l)||"null";return p=0===c.length?"[]":t?"[\n"+t+c.join(",\n"+t)+"\n"+s+"]":"["+c.join(",")+"]",t=s,p}if(r&&"object"==typeof r)for(a=r.length,i=0;i<a;i+=1)"string"==typeof r[i]&&(p=str(o=String(r[i]),l))&&c.push(quote(o)+(t?": ":":")+p);else for(o in l)Object.prototype.hasOwnProperty.call(l,o)&&(p=str(o,l))&&c.push(quote(o)+(t?": ":":")+p);return p=0===c.length?"{}":t?"{\n"+t+c.join(",\n"+t)+"\n"+s+"}":"{"+c.join(",")+"}",t=s,p}return"null"}}();var t={ppmName:"ppx-plugin-manager",ppmVersion:.95,language:"ja",encode:"utf16le",nlcode:"\r\n",nltype:"crlf",ppmID:"P",ppmSubID:"Q"},validArgs=function(){for(var t=[],e=PPx.Arguments;!e.atEnd();e.moveNext())t.push(e.value);return t},safeArgs=function(){for(var t=[],e=validArgs(),n=0,r=arguments.length;n<r;n++)t.push(_valueConverter(n<0||arguments.length<=n?undefined:arguments[n],e[n]));return t},_valueConverter=function(t,e){if(null==e||""===e)return null!=t?t:undefined;switch(typeof t){case"number":var n=Number(e);return isNaN(n)?t:n;case"boolean":return null!=e&&"false"!==e&&"0"!==e;default:return e}},isEmptyObj=function(t){if(t===undefined)return!1;if(null===t)return!0;for(var e in t)return!1;return!0};PPx.CreateObject("Scripting.FileSystemObject"),Array.prototype.removeEmpty||(Array.prototype.removeEmpty=function(){for(var t=[],e=0,n=this.length;e<n;e++){var r=this[e];null==r||""===r||r instanceof Array&&0===r.length||r instanceof Object&&isEmptyObj(r)||t.push(r)}return t});var e={BUTTON:"Edit_OptionCmd",CMD:"grepCmd",OUTPUT:"grepOutput",OPTION:"grepOption",COMPLIST:"grepComplist",OPT_FIXED:"fixed",OPT_ADDED:"added",OPT_FLEN:"flen",OPT_ALEN:"alen",MENU_ID:"M_ppmGrep",KEY_ID:"K_ppmGrep",SWITCH_KEY:"grep_switchkey",SWITCH_TYPE:"grep_switchtype",COMMIT_KEY:"grep_commitkey",COMMIT_HASH:"commitHash"},main=function(){var t=safeArgs(!1)[0],e=nextProp(t),n=JSON.parse(e.replace(/^[A-Z]+\s*=\s*/,"")),r=switchGrep(n);PPx.Execute(r),PPx.Execute("*setcaption ["+n.output+"] "+n.cmd+" "+n.option)},nextProp=function(n){if(n)return PPx.Extract('%k"down"%:%'+e.MENU_ID)||PPx.Quit(1);var r=PPx.Extract("%si'"+e.CMD+"'%si'"+e.OUTPUT+"'").toUpperCase();r=r.replace(" ","");for(var u=PPx.Extract("%*getcust("+e.MENU_ID+")").split(t.nlcode),i=u.length-3,o=1;o<i&&!~u[o].indexOf(r);o++);return u[o===i?1:++o]},switchGrep=function(t){var n=0===t.added.indexOf("-")?" ":"";return t.option=""+t.fixed+n+t.added,"*string i,"+e.CMD+"="+t.cmd+"%:*string i,"+e.OUTPUT+"="+t.output+"%:*string i,"+e.OPTION+"="+t.option+"%:*string e,"+e.COMPLIST+"="+t.listname+"%:*string e,"+e.OPT_FIXED+"="+t.fixed+"%:*string e,"+e.OPT_ADDED+"="+t.added+"%:*string e,"+e.OPT_FLEN+"="+t.fixed.length+"%:*string e,"+e.OPT_ALEN+"="+(t.fixed.length+n.length+t.added.length)};main();
